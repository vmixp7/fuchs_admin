<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>林口興業有限公司：德國福斯FUCHS潤滑油授權經銷商</title>
    <meta
      name="keywords"
      content="福斯潤滑油,oil,lube,fuchs,林口興業,機油,潤滑油,汽車,機車,重車,工業,海運"
    />
    <meta
      name="description"
      content="林口興業是台塑FORMOSA與福斯FUCHS潤滑油授權經銷商，提供汽車、機車、重車與工業用高階機油，品質卓越，客戶信賴。"
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="#" />
    <link rel="stylesheet" href="css/style.css?v=14" />
    <!-- Pushy -->
    <link rel="stylesheet" href="mobilemenu/pushy.css" />
    <!-- Link Swiper's CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link rel="stylesheet" href="css/bundle.min.css" />
    <link rel="stylesheet" href="css/megamenu.css" />
    <!-- fancybox -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1/dist/fancybox/fancybox.css"
    />
  </head>

  <body>
    <!-- pushy -->
    <nav class="pushy pushy-right">
      <div class="pushy-content">
        <ul>
          <li><a href="index.html">首頁</a></li>
          <li><a href="about.html">公司簡介</a></li>
          <li><a href="product.html">產品</a></li>
          <li><a href="ndustries.html">行業</a></li>
          <li><a href="brands.html">品牌故事</a></li>
          <li><a href="support.html">技術服務</a></li>
          <li><a href="contact.html">聯絡我們</a></li>
          <li><a href="qa.html">常見問題</a></li>
          <li><a href="jobs.html">人才招募</a></li>
        </ul>
        <div class="other-info">
          <a
            class="line"
            target="_blank"
            href="https://line.me/R/ti/p/@951cwutv"
            ><img src="images/qrcode.jpg" alt="line 好友"
          /></a>
          <p class="copyrights">Copyrights Ⓒ 2025 All Rights Reserved.</p>
        </div>
      </div>
    </nav>

    <!-- Site Overlay -->
    <div class="site-overlay"></div>

    <div id="container">
      <!-- start -->
      <header class="formosalube-header">
        <section class="info-content">
          <!-- <a href="index.html" class="logo">
                    <img src="images/logo.png" alt="林口興業 台塑潤滑油">
                </a> -->
          <a href="index.html" class="logo2">
            <img src="images/logo_202112.jpg" alt="林口興業 德國福斯潤滑油" />
          </a>
          <div class="right-menu">
            <div class="logo_title">
              <a href="index.html" class="logo1">
                <img
                  src="images/logo_white_edge2.png"
                  alt="林口興業 台塑潤滑油"
                />
              </a>
              <p class="slogan">Your trusted partner<br />值得您信賴的好伙伴</p>
            </div>
            <!-- Menu start-->
            <nav class="menu-item navbar navbar-expand-md static-nav">
              <ul class="navbar-nav ml-auto mr-auto">
                <li><a href="about.html">公司簡介</a></li>

                <li class="nav-item dropdown static">
                  <a
                    class="nav-link dropdown-toggle"
                    href="javascript:void(0)"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                  >
                    產品
                  </a>
                  <ul
                    id="menu-products"
                    class="dropdown-menu megamenu flexable-megamenu"
                  ></ul>
                </li>

                <li class="nav-item dropdown static">
                  <a
                    class="nav-link dropdown-toggle"
                    href="javascript:void(0)"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                  >
                    行業
                  </a>
                  <ul
                    id="menu-industries"
                    class="dropdown-menu megamenu flexable-megamenu"
                  ></ul>
                </li>

                <li class="nav-item dropdown static">
                  <a
                    class="nav-link dropdown-toggle"
                    href="javascript:void(0)"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                  >
                    品牌故事
                  </a>
                  <ul
                    id="menu-brands"
                    class="dropdown-menu megamenu flexable-megamenu"
                  ></ul>
                </li>
                <li><a href="support.html">技術服務</a></li>
                <li><a href="contact.html">聯絡我們</a></li>
                <li><a href="qa.html">常見問題</a></li>
                <li><a href="jobs.html">人才招募</a></li>
                <!-- <li><a class="line" target="_blank" href="https://line.me/R/ti/p/@951cwutv"><img src="images/qrcode.jpg" alt="line 好友"></a></li> -->
              </ul>
            </nav>
            <!-- Menu end-->
          </div>

          <a
            class="lineQrcode"
            target="_blank"
            href="https://line.me/R/ti/p/@951cwutv"
          >
            <img src="images/qrcode.jpg" alt="line 好友" />
          </a>
          <button class="menu-btn">
            <span></span>
          </button>
        </section>
      </header>

      <!-- main -->
      <main class="formosalube-container">
        <!-- 1 banner slider-->
        <section class="banner-slider inside-bn">
          <div class="mbox">
            <!-- Swiper -->
            <div class="swiper-cont">
              <div class="banner-text-block">
                <h2></h2>
              </div>
              <div class="swiper mySwiper">
                <div class="swiper-pagination"></div>
                <div class="swiper-wrapper">
                  <div class="swiper-slide">
                    <img
                      src="images/photo/banner_2.jpg"
                      width="100%"
                      loading="1"
                      alt=""
                    />
                  </div>
                  <div class="swiper-slide">
                    <img
                      src="images/photo/Excavator bulldozer in sandpit with raised bucket over blue cloudscape sky_shutterstock_excavatorSandpit_high.jpg"
                      width="100%"
                      loading="1"
                      alt=""
                    />
                  </div>
                  <div class="swiper-slide">
                    <img
                      src="images/photo/Oilrunner_II.jpg"
                      width="100%"
                      loading="1"
                      alt=""
                    />
                  </div>
                  <div class="swiper-slide">
                    <img
                      src="images/photo/Shutterstock_684981595.jpg"
                      width="100%"
                      loading="1"
                      alt=""
                    />
                  </div>
                  <div class="swiper-slide">
                    <img
                      src="images/photo/Shutterstock_1610700505.jpg"
                      width="100%"
                      loading="1"
                      alt=""
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- 2 -->
        <section class="info-content album-cont">
          <div class="mbox">
            <div class="text">
              <h4>公司相關活動</h4>
            </div>
            <div class="album-list" id="company-activity-list">
              <!-- Dynamic content will be loaded here -->
            </div>
            <div
              class="pagination-container"
              style="display: flex; justify-content: flex-end; margin-top: 20px"
            >
              <div id="pagination"></div>
            </div>
          </div>
        </section>
      </main>

      <!-- footer -->
      <footer class="formosalube-footer">
        <div class="mbox">
          <div class="copy-right-text">
            <p>
              <span>服務專線: 02-2609-6075</span>|<span>傳真: 02-2609-3761</span
              >|<span
                >E-mail:
                <a href="mailto:vcnt.chang@gmail.com"
                  >vcnt.chang@gmail.com</a
                ></span
              ><span>版權所有 © 2025 林口興業有限公司</span>
            </p>
          </div>
        </div>
      </footer>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="mobilemenu/pushy.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="js/menu.js?v=14"></script>
    <script src="js/script.js?v=14"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1/dist/fancybox/fancybox.umd.js"></script>
    <!-- Initialize Swiper -->
    <script>
      var bannerTextTimer;
      function updateBannerText(index) {
        var realIndex = index % bannerTexts.length;
        $(".banner-text-block h2").html(bannerTexts[realIndex]);
      }
      var swiper = new Swiper(".mySwiper", {
        effect: "fade",
        crossFade: true,
        loop: true,
        autoplay: {
          delay: 5000,
          disableOnInteraction: false,
        },
        pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
        navigation: {
          nextEl: ".swiper-button-next",
          prevEl: ".swiper-button-prev",
        },
        on: {
          slideChangeTransitionStart: function () {
            // 切換時隱藏文字
            clearTimeout(bannerTextTimer);
            $(".banner-text-block").removeClass("show");
          },
          slideChangeTransitionEnd: function () {
            var self = this;
            // 更新文字內容
            updateBannerText(self.realIndex);
            // 停頓1秒後顯示文字
            bannerTextTimer = setTimeout(function () {
              $(".banner-text-block").addClass("show");
            }, 1000);
          },
          init: function () {
            var self = this;
            // 初始化時設定文字
            updateBannerText(self.realIndex);
            // 1秒後顯示文字
            bannerTextTimer = setTimeout(function () {
              $(".banner-text-block").addClass("show");
            }, 1000);
          },
        },
      });

      Fancybox.bind("[data-fancybox]", {
        // Your custom options
      });

      // Company Activity pagination functionality
      var currentPage = 1;
      var totalPages = 1;

      // Load company activities
      function loadCompanyActivities(page = 1) {
        currentPage = page;

        $.ajax({
          url: `${BASE_URL}/api/company-activities?page=${page}&limit=6`,
          type: "GET",
          dataType: "json",
          success: function (response) {
            var activityList = $("#company-activity-list");
            activityList.empty();

            if (response.data && response.data.length > 0) {
              response.data.forEach(function (item, index) {
                var galleryId = "gallery" + (index + 1);
                var title = item.title || "";
                var date = item.startday || "";

                // Format date if needed (YYYYMMDD to YYYY-MM-DD)
                if (date && date.length === 8) {
                  date = `${date.slice(0, 4)}-${date.slice(4, 6)}-${date.slice(6, 8)}`;
                }

                var albumHtml = '<div class="a-album">';

                // Add all images for this album (up to 20 images for company activities)
                for (var i = 1; i <= 20; i++) {
                  var imgNum = i.toString().padStart(2, "0");
                  var fname = `Y${item.startday}_${imgNum}.jpg`;
                  var imgUrl = `${FORMOSA_URL}/images/company/${fname}`;

                  if (i === 1) {
                    albumHtml += `
                                    <a data-fancybox="${galleryId}" class="album-cover" rel="${galleryId}"
                                        href="${imgUrl}" title="${title}">
                                        <img src="${imgUrl}">
                                    </a>`;
                  } else {
                    albumHtml += `<a data-fancybox="${galleryId}" rel="${galleryId}" href="${imgUrl}" title=""></a>`;
                  }
                }

                albumHtml += `
                            <figcaption>
                                <p class="album-title">${title}</p>
                                <p class="album-date">日期：${date}</p>
                            </figcaption>
                        </div>`;

                activityList.append(albumHtml);
              });

              // Rebind Fancybox after dynamic content is added
              Fancybox.bind("[data-fancybox]", {});

              // Update pagination
              if (response.pagination) {
                totalPages = response.pagination.totalPages;
                renderPagination();
              }
            } else {
              activityList.html("<p>目前沒有公司活動資料</p>");
            }
          },
          error: function (xhr, status, error) {
            console.error("載入公司活動失敗:", error);
            $("#company-activity-list").html(
              "<p>載入公司活動資料時發生錯誤</p>",
            );
          },
        });
      }

      // Render pagination
      function renderPagination() {
        if (totalPages <= 1) {
          $("#pagination").hide();
          return;
        }

        $("#pagination").css("display", "flex");
        var paginationHtml = "";
        let maxButtons = 5;
        if (window.innerWidth <= 500) {
          maxButtons = 2;
        }

        // 上一頁按鈕
        if (currentPage > 1) {
          paginationHtml +=
            '<button onclick="loadCompanyActivities(' +
            (currentPage - 1) +
            ')" style="margin: 0 5px; padding: 8px 15px; border: 1px solid #3559f6; background: white; color: #3559f6; cursor: pointer; border-radius: 4px;">上一頁</button>';
        }

        var startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
        var endPage = Math.min(totalPages, startPage + maxButtons - 1);

        if (endPage - startPage + 1 < maxButtons) {
          startPage = Math.max(1, endPage - maxButtons + 1);
        }

        // First page
        if (startPage > 1) {
          paginationHtml +=
            '<button onclick="loadCompanyActivities(1)" style="margin: 0 5px; padding: 8px 15px; border: 1px solid #3559f6; background: white; color: #3559f6; cursor: pointer; border-radius: 4px;">1</button>';
          if (startPage > 2) {
            paginationHtml +=
              '<span style="margin: 0 5px; padding: 8px 0;">...</span>';
          }
        }

        // Page buttons
        for (var i = startPage; i <= endPage; i++) {
          if (i === currentPage) {
            paginationHtml +=
              '<button style="margin: 0 5px; padding: 8px 15px; border: 1px solid #3559f6; background: #3559f6; color: white; cursor: pointer; border-radius: 4px; font-weight: bold;">' +
              i +
              "</button>";
          } else {
            paginationHtml +=
              '<button onclick="loadCompanyActivities(' +
              i +
              ')" style="margin: 0 5px; padding: 8px 15px; border: 1px solid #3559f6; background: white; color: #3559f6; cursor: pointer; border-radius: 4px;">' +
              i +
              "</button>";
          }
        }

        // Last page
        if (endPage < totalPages) {
          if (endPage < totalPages - 1) {
            paginationHtml +=
              '<span style="margin: 0 5px; padding: 8px 0;">...</span>';
          }
          paginationHtml +=
            '<button onclick="loadCompanyActivities(' +
            totalPages +
            ')" style="margin: 0 5px; padding: 8px 15px; border: 1px solid #3559f6; background: white; color: #3559f6; cursor: pointer; border-radius: 4px;">' +
            totalPages +
            "</button>";
        }

        // 下一頁按鈕
        if (currentPage < totalPages) {
          paginationHtml +=
            '<button onclick="loadCompanyActivities(' +
            (currentPage + 1) +
            ')" style="margin: 0 5px; padding: 8px 15px; border: 1px solid #3559f6; background: white; color: #3559f6; cursor: pointer; border-radius: 4px;">下一頁</button>';
        }

        $("#pagination").html(paginationHtml);
      }

      // Load initial data when page loads
      $(document).ready(function () {
        loadCompanyActivities(1);
      });
    </script>
  </body>
</html>
